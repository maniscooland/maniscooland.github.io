<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Battle Royale Vehicles</title>
    <style>
        body, html { margin: 0; padding: 0; overflow: hidden; }
        canvas { display: block; }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const map = {
            width: 4000,
            height: 3000,
            roadWidth: 200,
            buildings: []
        };

        for (let i = 0; i < 40; i++) {
            map.buildings.push({
                x: Math.random() * map.width,
                y: Math.random() * map.height,
                width: 100 + Math.random() * 200,
                height: 100 + Math.random() * 200
            });
        }

        const vehicleTypes = [
            { type: 'car', width: 50, height: 30, speed: 4, color: '#4286f4' },
            { type: 'truck', width: 70, height: 40, speed: 3, color: '#41f468' },
            { type: 'tank', width: 60, height: 40, speed: 2, color: '#006400' }
        ];

        function createVehicle(isPlayer = false) {
            const type = vehicleTypes[Math.floor(Math.random() * vehicleTypes.length)];
            return {
                ...type,
                x: Math.random() * map.width,
                y: Math.random() * map.height,
                angle: Math.random() * Math.PI * 2,
                steeringAngle: 0,
                maxSteeringAngle: Math.PI / 4,
                isPlayer: isPlayer
            };
        }

        const player = createVehicle(true);
        player.x = 400;
        player.y = 300;

        const aiVehicles = [];
        for (let i = 0; i < 20; i++) {
            aiVehicles.push(createVehicle());
        }

        const bullets = [];
        const camera = { x: 0, y: 0 };

        function drawMap() {
            ctx.fillStyle = '#7CFC00';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = '#8B4513';
            ctx.fillRect(map.width / 2 - map.roadWidth / 2 - camera.x, 0, map.roadWidth, canvas.height);
            ctx.fillRect(0, map.height / 2 - map.roadWidth / 2 - camera.y, canvas.width, map.roadWidth);

            ctx.fillStyle = '#808080';
            map.buildings.forEach(building => {
                ctx.fillRect(building.x - camera.x, building.y - camera.y, building.width, building.height);
                ctx.fillStyle = '#A9A9A9';
                ctx.fillRect(building.x + building.width / 2 - 10 - camera.x, building.y - 10 - camera.y, 20, 10);
                ctx.fillStyle = '#808080';
            });
        }

        function drawVehicle(vehicle) {
            ctx.save();
            ctx.translate(vehicle.x - camera.x, vehicle.y - camera.y);
            ctx.rotate(vehicle.angle);

            ctx.fillStyle = vehicle.color;
            ctx.fillRect(-vehicle.width / 2, -vehicle.height / 2, vehicle.width, vehicle.height);

            if (vehicle.type === 'tank') {
                ctx.fillStyle = '#008000';
                ctx.fillRect(-10, -20, 20, 40);
            }

            ctx.save();
            ctx.rotate(vehicle.steeringAngle);
            ctx.fillStyle = '#000000';
            ctx.fillRect(-vehicle.width / 2 + 5, -vehicle.height / 2 - 5, 10, 10);
            ctx.fillRect(vehicle.width / 2 - 15, -vehicle.height / 2 - 5, 10, 10);
            ctx.restore();

            ctx.restore();
        }

        function drawBullets() {
            ctx.fillStyle = '#FF0000';
            bullets.forEach(bullet => {
                ctx.beginPath();
                ctx.arc(bullet.x - camera.x, bullet.y - camera.y, 3, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        function updateBullets() {
            for (let i = bullets.length - 1; i >= 0; i--) {
                bullets[i].x += Math.cos(bullets[i].angle) * 10;
                bullets[i].y += Math.sin(bullets[i].angle) * 10;

                if (bullets[i].x < 0 || bullets[i].x > map.width || bullets[i].y < 0 || bullets[i].y > map.height) {
                    bullets.splice(i, 1);
                }
            }
        }

        function shoot() {
            if (player.type === 'tank') {
                bullets.push({
                    x: player.x + Math.cos(player.angle) * 40,
                    y: player.y + Math.sin(player.angle) * 40,
                    angle: player.angle
                });
            }
        }

        function checkCollision(obj1, obj2) {
            return obj1.x < obj2.x + obj2.width &&
                   obj1.x + obj1.width > obj2.x &&
                   obj1.y < obj2.y + obj2.height &&
                   obj1.y + obj1.height > obj2.y;
        }

        function updateVehicle(vehicle) {
            let newX = vehicle.x;
            let newY = vehicle.y;

            if (vehicle.isPlayer) {
                if (keys.w) {
                    newX += Math.cos(vehicle.angle) * vehicle.speed;
                    newY += Math.sin(vehicle.angle) * vehicle.speed;
                }
                if (keys.s) {
                    newX -= Math.cos(vehicle.angle) * vehicle.speed / 2;
                    newY -= Math.sin(vehicle.angle) * vehicle.speed / 2;
                }
                if (keys.a) vehicle.steeringAngle = Math.max(-vehicle.maxSteeringAngle, vehicle.steeringAngle - 0.05);
                if (keys.d) vehicle.steeringAngle = Math.min(vehicle.maxSteeringAngle, vehicle.steeringAngle + 0.05);
            } else {
                newX += Math.cos(vehicle.angle) * vehicle.speed;
                newY += Math.sin(vehicle.angle) * vehicle.speed;

                if (Math.random() < 0.02) {
                    vehicle.steeringAngle = (Math.random() - 0.5) * vehicle.maxSteeringAngle * 2;
                }
            }

            vehicle.angle += vehicle.steeringAngle * vehicle.speed / 30;

            let collision = false;
            map.buildings.forEach(building => {
                if (checkCollision({x: newX, y: newY, width: vehicle.width, height: vehicle.height}, building)) {
                    collision = true;
                }
            });

            if (!collision) {
                vehicle.x = newX;
                vehicle.y = newY;
            }

            vehicle.x = Math.max(0, Math.min(map.width, vehicle.x));
            vehicle.y = Math.max(0, Math.min(map.height, vehicle.y));

            vehicle.steeringAngle *= 0.9;
        }

        function update() {
            updateVehicle(player);
            aiVehicles.forEach(ai => updateVehicle(ai));

            camera.x = player.x - canvas.width / 2;
            camera.y = player.y - canvas.height / 2;

            camera.x = Math.max(0, Math.min(map.width - canvas.width, camera.x));
            camera.y = Math.max(0, Math.min(map.height - canvas.height, camera.y));

            updateBullets();
        }

        function render() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawMap();
            drawVehicle(player);
            aiVehicles.forEach(ai => drawVehicle(ai));
            drawBullets();
        }

        function gameLoop() {
            update();
            render();
            requestAnimationFrame(gameLoop);
        }

        const keys = {};

        window.addEventListener('keydown', e => keys[e.key] = true);
        window.addEventListener('keyup', e => keys[e.key] = false);

        canvas.addEventListener('mousemove', e => {
            const rect = canvas.getBoundingClientRect();
            const mouseX = e.clientX - rect.left + camera.x;
            const mouseY = e.clientY - rect.top + camera.y;
            player.angle = Math.atan2(mouseY - player.y, mouseX - player.x);
        });

        canvas.addEventListener('click', shoot);

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        gameLoop();
    </script>
</body>
</html>
