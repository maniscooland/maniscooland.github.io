<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Battle Royale Game</title><style>body,html{margin:0;padding:0;overflow:hidden}canvas{display:block}</style></head><body><canvas id="gameCanvas"></canvas><script>
const canvas=document.getElementById("gameCanvas"),ctx=canvas.getContext("2d");canvas.width=window.innerWidth,canvas.height=window.innerHeight;const map={width:4e3,height:3e3,roadWidth:200,buildings:[],presents:[]},player={x:400,y:300,width:40,height:40,speed:3,angle:0,inVehicle:null,keys:[],gun:null,ammo:0,magazineSize:10,magazineAmmo:0},vehicles=[],bullets=[],camera={x:0,y:0},vehicleTypes=[{type:"car",width:50,height:30,speed:4,color:"#4286f4",capacity:2},{type:"truck",width:70,height:40,speed:3,color:"#41f468",capacity:2}],guns=[{name:"pistol",color:"#8B4513",length:20},{name:"shotgun",color:"#A0522D",length:30},{name:"rifle",color:"#D2691E",length:40}],playerImage=new Image;playerImage.src="player.png";const aiPlayers=[];for(let e=0;e<10;e++)aiPlayers.push({x:Math.random()*map.width,y:Math.random()*map.height,width:40,height:40,speed:2,angle:2*Math.random()*Math.PI,inVehicle:null,gun:guns[Math.floor(Math.random()*guns.length)],ammo:400,magazineSize:10,magazineAmmo:10,state:"wandering",target:null,targetTimer:0});for(let e=0;e<40;e++)map.buildings.push({x:Math.random()*map.width,y:Math.random()*map.height,width:100+200*Math.random(),height:100+200*Math.random(),number:e+1,gun:guns[Math.floor(Math.random()*guns.length)]});for(let e=0;e<100;e++)map.presents.push({x:Math.random()*map.width,y:Math.random()*map.height,width:20,height:20,key:Math.floor(40*Math.random())+1});for(let e=0;e<4;e++){const t=vehicleTypes[Math.floor(Math.random()*vehicleTypes.length)];vehicles.push({...t,x:Math.random()*map.width,y:Math.random()*map.height,angle:2*Math.random()*Math.PI,steeringAngle:0,maxSteeringAngle:Math.PI/4,driver:null,passenger:null})}function drawMap(){ctx.fillStyle="#7CFC00",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle="#8B4513",ctx.fillRect(map.width/2-map.roadWidth/2-camera.x,0,map.roadWidth,canvas.height),ctx.fillRect(0,map.height/2-map.roadWidth/2-camera.y,canvas.width,map.roadWidth),ctx.fillStyle="#808080",map.buildings.forEach(e=>{ctx.fillRect(e.x-camera.x,e.y-camera.y,e.width,e.height),ctx.fillStyle="#A9A9A9",ctx.fillRect(e.x+e.width/2-10-camera.x,e.y-10-camera.y,20,10),ctx.fillStyle="#000000",ctx.font="20px Arial",ctx.fillText(e.number,e.x+10-camera.x,e.y+30-camera.y),ctx.fillStyle="#808080"}),ctx.fillStyle="#FF0000",map.presents.forEach(e=>{ctx.fillRect(e.x-camera.x,e.y-camera.y,e.width,e.height)})}function drawVehicle(e){ctx.save(),ctx.translate(e.x-camera.x,e.y-camera.y),ctx.rotate(e.angle),ctx.fillStyle=e.color,ctx.fillRect(-e.width/2,-e.height/2,e.width,e.height),ctx.fillStyle="#000000",ctx.save(),ctx.translate(e.width/2-10,-e.height/2),ctx.rotate(e.steeringAngle),ctx.fillRect(-5,-5,10,10),ctx.restore(),ctx.save(),ctx.translate(e.width/2-10,e.height/2),ctx.rotate(e.steeringAngle),ctx.fillRect(-5,-5,10,10),ctx.restore(),ctx.fillRect(-e.width/2+5,-e.height/2-5,10,10),ctx.fillRect(-e.width/2+5,e.height/2-5,10,10),ctx.restore()}function drawPlayer(e,t=!1){ctx.save(),ctx.translate(e.x-camera.x,e.y-camera.y),ctx.rotate(e.angle+Math.PI/2),t?(ctx.fillStyle="#FF0000",ctx.fillRect(-e.width/2,-e.height/2,e.width,e.height)):ctx.drawImage(playerImage,-e.width/2,-e.height/2,e.width,e.height),e.gun&&(ctx.save(),ctx.translate(e.width/2,0),ctx.rotate(-Math.PI/2),ctx.fillStyle=e.gun.color,ctx.fillRect(0,-2,e.gun.length,4),ctx.restore()),ctx.restore()}function drawBullets(){ctx.fillStyle="#FF0000",bullets.forEach(e=>{ctx.beginPath(),ctx.arc(e.x-camera.x,e.y-camera.y,3,0,2*Math.PI),ctx.fill()})}function drawHUD(){ctx.fillStyle="#000000",ctx.font="20px Arial",ctx.fillText(`Keys: ${player.keys.join(", ")}`,10,30),ctx.fillText(`Gun: ${player.gun?player.gun.name:"None"}`,10,60),ctx.fillText(`Ammo: ${player.magazineAmmo}/${player.ammo}`,10,90)}function updateBullets(){for(let e=bullets.length-1;e>=0;e--)bullets[e].x+=10*Math.cos(bullets[e].angle),bullets[e].y+=10*Math.sin(bullets[e].angle),(bullets[e].x<0||bullets[e].x>map.width||bullets[e].y<0||bullets[e].y>map.height)&&bullets.splice(e,1)}function shoot(e){e.gun&&e.magazineAmmo>0&&(bullets.push({x:e.x+30*Math.cos(e.angle),y:e.y+30*Math.sin(e.angle),angle:e.angle}),e.magazineAmmo--)}function reload(e){if(e.gun&&e.ammo>0){const t=e.magazineSize-e.magazineAmmo,a=Math.min(t,e.ammo);e.magazineAmmo+=a,e.ammo-=a}}function checkCollision(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function updateAI(e){switch(e.state){case"wandering":if(e.x+=Math.cos(e.angle)*e.speed,e.y+=Math.sin(e.angle)*e.speed,Math.random()<.02&&(e.angle=2*Math.random()*Math.PI),!e.inVehicle){let t=null,a=1/0;if(map.presents.forEach(n=>{const i=Math.hypot(n.x-e.x,n.y-e.y);i<a&&(t=n,a=i)}),t&&a<200)e.state="seeking",e.target=t;else{let n=null,i=1/0;vehicles.forEach(l=>{if(!l.driver||!l.passenger){const h=Math.hypot(l.x-e.x,l.y-e.y);h<i&&(n=l,i=h)}}),n&&i<100&&(e.state="seeking_vehicle",e.target=n)}}break;case"seeking":const t=e.target.x-e.x,a=e.target.y-e.y;if(e.angle=Math.atan2(a,t),e.x+=Math.cos(e.angle)*e.speed,e.y+=Math.sin(e.angle)*e.speed,checkCollision(e,e.target)){const n=map.presents.indexOf(e.target);n>-1&&map.presents.splice(n,1),e.state="wandering",e.target=null}if(e.targetTimer++,e.targetTimer>300)e.state="wandering",e.target=null,e.targetTimer=0;break;case"seeking_vehicle":const n=e.target.x-e.x,i=e.target.y-e.y;if(e.angle=Math.atan2(i,n),e.x+=Math.cos(e.angle)*e.speed,e.y+=Math.sin(e.angle)*e.speed,Math.hypot(n,i)<10){const l=e.target;l.driver?l.passenger||(l.passenger=e):l.driver=e,e.inVehicle=l,e.state="wandering",e.target=null}if(e.targetTimer++,e.targetTimer>300)e.state="wandering",e.target=null,e.targetTimer=0}map.buildings.forEach(t=>{if(checkCollision(e,t)){const a=Math.min(e.x+e.width-t.x,t.x+t.width-e.x),n=Math.min(e.y+e.height-t.y,t.y+t.height-e.y);a<n?e.x+=e.x<t.x?-a:a:e.y+=e.y<t.y?-n:n}}),e.x=Math.max(0,Math.min(map.width,e.x)),e.y=Math.max(0,Math.min(map.height,e.y)),Math.random()<.01&&shoot(e),0===e.magazineAmmo&&Math.random()<.1&&reload(e)}function update(){if(player.inVehicle){const e=player.inVehicle;keys.w&&(e.x+=Math.cos(e.angle)*e.speed,e.y+=Math.sin(e.angle)*e.speed),keys.s&&(e.x-=Math.cos(e.angle)*e.speed/2,e.y-=Math.sin(e.angle)*e.speed/2),keys.a&&(e.steeringAngle=Math.max(-e.maxSteeringAngle,e.steeringAngle-.05)),keys.d&&(e.steeringAngle=Math.min(e.maxSteeringAngle,e.steeringAngle+.05)),e.angle+=e.steeringAngle*e.speed/30,e.steeringAngle*=.9,player.x=e.x,player.y=e.y,player.angle=e.angle}else keys.w&&(player.y-=player.speed),keys.s&&(player.y+=player.speed),keys.a&&(player.x-=player.speed),keys.d&&(player.x+=player.speed);aiPlayers.forEach(updateAI),vehicles.forEach(e=>{e.driver&&(e.x+=Math.cos(e.angle)*e.speed,e.y+=Math.sin(e.angle)*e.speed,e.x=Math.max(0,Math.min(map.width,e.x)),e.y=Math.max(0,Math.min(map.height,e.y)))}),map.buildings.forEach(e=>{if(checkCollision(player,e))if(player.keys.includes(e.number))player.gun=e.gun,player.ammo=400,player.magazineAmmo=player.magazineSize,player.keys=player.keys.filter(t=>t!==e.number);else{const t=Math.min(player.x+player.width-e.x,e.x+e.width-player.x),a=Math.min(player.y+player.height-e.y,e.y+e.height-player.y);t<a?player.x+=player.x<e.x?-t:t:player.y+=player.y<e.y?-a:a}}),map.presents.forEach((e,t)=>{checkCollision(player,e)&&(player.keys.push(e.key),map.presents.splice(t,1))}),keys.e&&(player.inVehicle?(player.inVehicle.driver===player?player.inVehicle.driver=null:player.inVehicle.passenger=null,player.inVehicle=null,player.x+=40*Math.cos(player.angle),player.y+=40*Math.sin(player.angle)):vehicles.forEach(e=>{Math.hypot(player.x-e.x,player.y-e.y)<50&&(e.driver?e.passenger||(e.passenger=player):e.driver=player,player.inVehicle=e)}),keys.e=!1),keys.r&&(reload(player),keys.r=!1),player.x=Math.max(0,Math.min(map.width,player.x)),player.y=Math.max(0,Math.min(map.height,player.y)),camera.x=player.x-canvas.width/2,camera.y=player.y-canvas.height/2,camera.x=Math.max(0,Math.min(map.width-canvas.width,camera.x)),camera.y=Math.max(0,Math.min(map.height-canvas.height,camera.y)),updateBullets()}function render(){ctx.clearRect(0,0,canvas.width,canvas.height),drawMap(),vehicles.forEach(drawVehicle),aiPlayers.forEach(e=>drawPlayer(e,!0)),drawPlayer(player),drawBullets(),drawHUD()}function gameLoop(){update(),render(),requestAnimationFrame(gameLoop)}const keys={};window.addEventListener("keydown",e=>keys[e.key]=!0),window.addEventListener("keyup",e=>keys[e.key]=!1),canvas.addEventListener("mousemove",e=>{const t=canvas.getBoundingClientRect(),a=e.clientX-t.left+camera.x,n=e.clientY-t.top+camera.y;player.angle=Math.atan2(n-player.y,a-player.x)-Math.PI/2}),canvas.addEventListener("click",()=>shoot(player)),window.addEventListener("resize",()=>{canvas.width=window.innerWidth,canvas.height=window.innerHeight}),gameLoop();
</script></body></html>
