<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tank Battle Royale</title>
    <style>
        canvas { border: 1px solid black; }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Map
        const map = {
            width: 2000,
            height: 1500,
            roadWidth: 100,
            buildings: []
        };

        // Generate buildings
        for (let i = 0; i < 20; i++) {
            map.buildings.push({
                x: Math.random() * map.width,
                y: Math.random() * map.height,
                width: 50 + Math.random() * 100,
                height: 50 + Math.random() * 100
            });
        }

        // Player tank
        const player = {
            x: 400,
            y: 300,
            speed: 3,
            angle: 0,
            wheelAngle: 0,
            width: 60,
            height: 40
        };

        // Bullets
        const bullets = [];

        // Camera
        const camera = {
            x: 0,
            y: 0
        };

        function drawMap() {
            // Draw grass
            ctx.fillStyle = '#7CFC00';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw dirt road
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(map.width / 2 - map.roadWidth / 2 - camera.x, 0, map.roadWidth, canvas.height);
            ctx.fillRect(0, map.height / 2 - map.roadWidth / 2 - camera.y, canvas.width, map.roadWidth);

            // Draw buildings
            ctx.fillStyle = '#808080';
            map.buildings.forEach(building => {
                ctx.fillRect(building.x - camera.x, building.y - camera.y, building.width, building.height);
                // Draw vent
                ctx.fillStyle = '#A9A9A9';
                ctx.fillRect(building.x + building.width / 2 - 10 - camera.x, building.y - 10 - camera.y, 20, 10);
                ctx.fillStyle = '#808080';
            });
        }

        function drawTank() {
            ctx.save();
            ctx.translate(player.x - camera.x, player.y - camera.y);
            ctx.rotate(player.angle);

            // Tank body
            ctx.fillStyle = '#006400';
            ctx.fillRect(-player.width / 2, -player.height / 2, player.width, player.height);

            // Tank turret
            ctx.fillStyle = '#008000';
            ctx.fillRect(-10, -20, 20, 40);

            // Tank wheels
            ctx.save();
            ctx.rotate(player.wheelAngle);
            ctx.fillStyle = '#000000';
            ctx.fillRect(-30, -25, 10, 10);
            ctx.fillRect(20, -25, 10, 10);
            ctx.fillRect(-30, 15, 10, 10);
            ctx.fillRect(20, 15, 10, 10);
            ctx.restore();

            ctx.restore();
        }

        function drawBullets() {
            ctx.fillStyle = '#FF0000';
            bullets.forEach(bullet => {
                ctx.beginPath();
                ctx.arc(bullet.x - camera.x, bullet.y - camera.y, 3, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        function updateBullets() {
            for (let i = bullets.length - 1; i >= 0; i--) {
                bullets[i].x += Math.cos(bullets[i].angle) * 10;
                bullets[i].y += Math.sin(bullets[i].angle) * 10;

                // Remove bullets that are out of bounds
                if (bullets[i].x < 0 || bullets[i].x > map.width || bullets[i].y < 0 || bullets[i].y > map.height) {
                    bullets.splice(i, 1);
                }
            }
        }

        function shoot() {
            bullets.push({
                x: player.x + Math.cos(player.angle) * 40,
                y: player.y + Math.sin(player.angle) * 40,
                angle: player.angle
            });
        }

        function update() {
            if (keys.w) {
                player.x += Math.cos(player.angle) * player.speed;
                player.y += Math.sin(player.angle) * player.speed;
            }
            if (keys.s) {
                player.x -= Math.cos(player.angle) * player.speed / 2;
                player.y -= Math.sin(player.angle) * player.speed / 2;
            }
            if (keys.a) {
                player.angle -= 0.05;
                player.wheelAngle -= 0.1;
            }
            if (keys.d) {
                player.angle += 0.05;
                player.wheelAngle += 0.1;
            }

            // Keep player in bounds
            player.x = Math.max(0, Math.min(map.width, player.x));
            player.y = Math.max(0, Math.min(map.height, player.y));

            // Update camera
            camera.x = player.x - canvas.width / 2;
            camera.y = player.y - canvas.height / 2;

            // Keep camera in bounds
            camera.x = Math.max(0, Math.min(map.width - canvas.width, camera.x));
            camera.y = Math.max(0, Math.min(map.height - canvas.height, camera.y));

            updateBullets();
        }

        function render() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawMap();
            drawTank();
            drawBullets();
        }

        function gameLoop() {
            update();
            render();
            requestAnimationFrame(gameLoop);
        }

        const keys = {};

        window.addEventListener('keydown', e => keys[e.key] = true);
        window.addEventListener('keyup', e => keys[e.key] = false);

        canvas.addEventListener('mousemove', e => {
            const rect = canvas.getBoundingClientRect();
            const mouseX = e.clientX - rect.left + camera.x;
            const mouseY = e.clientY - rect.top + camera.y;
            player.angle = Math.atan2(mouseY - player.y, mouseX - player.x);
        });

        canvas.addEventListener('click', shoot);

        gameLoop();
    </script>
</body>
</html>
