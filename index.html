<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Battle Royale Game</title><style>body,html{margin:0;padding:0;overflow:hidden}canvas{display:block}#menu{position:absolute;left:10px;top:10px;background:rgba(0,0,0,0.7);color:white;padding:10px}.weapon-slot{width:100px;height:100px;margin:5px;cursor:pointer}#skinSelect,#gloveSelect{margin-top:10px}</style></head><body><div id="menu"><h3>Choose Weapon</h3><div id="weaponSlots"></div><select id="skinSelect"></select><select id="gloveSelect"></select><input id="username" placeholder="Enter username"><button id="startGame">Start Game</button></div><canvas id="gameCanvas"></canvas><script>const canvas=document.getElementById("gameCanvas"),ctx=canvas.getContext("2d");canvas.width=window.innerWidth,canvas.height=window.innerHeight;const map={width:4e3,height:3e3,roadWidth:200,buildings:[],doors:[]},player={x:400,y:300,width:40,height:40,speed:3,angle:0,inVehicle:null,inBuilding:null,gun:null,ammo:400,magazineSize:10,magazineAmmo:10,username:"Player",health:100,skin:"default",gloves:"default"},vehicles=[],bullets=[],camera={x:0,y:0},vehicleTypes=[{type:"car",width:80,height:50,speed:4,color:"#4286f4",capacity:2},{type:"truck",width:100,height:60,speed:3,color:"#41f468",capacity:2}],guns=[{name:"pistol",color:"#8B4513",length:20,image:"pistol.png",displayImage:"pistolD.png",bulletCount:1,damage:2,slot:"P"},{name:"shotgun",color:"#A0522D",length:30,image:"shotgun.png",displayImage:"shotgunD.png",bulletCount:4,damage:5,slot:"S"},{name:"rifle",color:"#D2691E",length:40,image:"rifle.png",displayImage:"rifleD.png",bulletCount:1,damage:3,slot:"R"},{name:"aShotgun",color:"#8B4513",length:35,image:"aShotgun.png",displayImage:"aShotgunD.png",bulletCount:4,damage:6,slot:"S"}],skins=["default","red","blue","green"],gloves=[{name:"default",images:["ga1.png","ga2.png"]},{name:"type_b",images:["gb1.png","gb2.png"]}],playerImage=new Image;playerImage.src="player.png";const gunImages={},gunDisplayImages={},gloveImages={};guns.forEach(e=>{gunImages[e.name]=new Image,gunImages[e.name].src=e.image,gunDisplayImages[e.name]=new Image,gunDisplayImages[e.name].src=e.displayImage}),gloves.forEach(e=>{gloveImages[e.name]=e.images.map(n=>{const t=new Image;return t.src=n,t})});const aiPlayers=[];for(let e=0;e<10;e++)aiPlayers.push({x:Math.random()*map.width,y:Math.random()*map.height,width:40,height:40,speed:2,angle:2*Math.random()*Math.PI,inVehicle:null,inBuilding:null,gun:guns[Math.floor(Math.random()*guns.length)],ammo:400,magazineSize:10,magazineAmmo:10,state:"wandering",target:null,targetTimer:0,username:"AI_"+e,health:100,skin:skins[Math.floor(Math.random()*skins.length)],gloves:gloves[Math.floor(Math.random()*gloves.length)].name});for(let e=0;e<20;e++){const n={x:Math.random()*map.width,y:Math.random()*map.height,width:200+200*Math.random(),height:200+200*Math.random(),interior:{color:"#D2B48C"}};let t=!1;for(const a of map.buildings)if(checkCollision(n,a)){t=!0;break}t||(map.buildings.push(n),map.doors.push({x:n.x+n.width/2,y:n.y+n.height,width:40,height:60,isOpen:!1,openAngle:0}))}for(let e=0;e<4;e++){const n=vehicleTypes[Math.floor(Math.random()*vehicleTypes.length)];vehicles.push({...n,x:Math.random()*map.width,y:Math.random()*map.height,angle:2*Math.random()*Math.PI,steeringAngle:0,maxSteeringAngle:Math.PI/4,driver:null,passenger:null})}function drawMap(){ctx.fillStyle="#7CFC00",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle="#8B4513",ctx.fillRect(map.width/2-map.roadWidth/2-camera.x,0,map.roadWidth,canvas.height),ctx.fillRect(0,map.height/2-map.roadWidth/2-camera.y,canvas.width,map.roadWidth),ctx.fillStyle="#808080",map.buildings.forEach(e=>{ctx.fillRect(e.x-camera.x,e.y-camera.y,e.width,e.height),player.inBuilding===e&&(ctx.fillStyle=e.interior.color,ctx.fillRect(e.x-camera.x,e.y-camera.y,e.width,e.height),ctx.fillStyle="#808080")}),ctx.fillStyle="#8B4513",map.doors.forEach(e=>{ctx.save(),ctx.translate(e.x-camera.x,e.y-camera.y),ctx.rotate(e.openAngle),ctx.fillRect(-e.width/2,0,e.width,e.height),ctx.restore()})}function drawVehicle(e){ctx.save(),ctx.translate(e.x-camera.x,e.y-camera.y),ctx.rotate(e.angle),ctx.fillStyle=e.color,ctx.fillRect(-e.width/2,-e.height/2,e.width,e.height),ctx.fillStyle="#000000",ctx.save(),ctx.translate(e.width/2-10,-e.height/2),ctx.rotate(e.steeringAngle),ctx.fillRect(-5,-5,10,10),ctx.restore(),ctx.save(),ctx.translate(e.width/2-10,e.height/2),ctx.rotate(e.steeringAngle),ctx.fillRect(-5,-5,10,10),ctx.restore(),ctx.fillRect(-e.width/2+5,-e.height/2-5,10,10),ctx.fillRect(-e.width/2+5,e.height/2-5,10,10),ctx.restore(),e.driver&&drawPlayer(e.driver,!0,e),e.passenger&&drawPlayer(e.passenger,!0,e)}function drawPlayer(e,n=!1,t=null){ctx.save(),n?ctx.translate(t.x-camera.x,t.y-camera.y):ctx.translate(e.x-camera.x,e.y-camera.y),ctx.rotate(e.angle),ctx.fillStyle=e.skin,ctx.fillRect(-e.width/2,-e.height/2,e.width,e.height),ctx.drawImage(playerImage,-e.width/2,-e.height/2,e.width,e.height),e.gun&&(ctx.drawImage(gunImages[e.gun.name],e.width/2,-e.height/4,e.gun.length,e.height/2),ctx.drawImage(gloveImages[e.gloves][0],e.width/2-5,-e.height/4-5,10,10),ctx.drawImage(gloveImages[e.gloves][1],e.width/2+5,-e.height/4+5,10,10)),ctx.fillStyle="#000",ctx.font="12px Arial",ctx.fillText(e.username,-20,30),ctx.fillStyle="red",ctx.fillRect(-20,-25,40,5),ctx.fillStyle="green",ctx.fillRect(-20,-25,40*e.health/100,5),ctx.restore()}function drawBullets(){ctx.fillStyle="#FF0000",bullets.forEach(e=>{ctx.beginPath(),ctx.arc(e.x-camera.x,e.y-camera.y,3,0,2*Math.PI),ctx.fill()})}function drawHUD(){ctx.fillStyle="#000000",ctx.font="20px Arial",ctx.fillText(`Health: ${player.health}`,10,30),ctx.fillText(`Gun: ${player.gun?player.gun.name:"None"}`,10,60),ctx.fillText(`Ammo: ${player.magazineAmmo}/${player.ammo}`,10,90)}function updateBullets(){for(let e=bullets.length-1;e>=0;e--){bullets[e].x+=10*Math.cos(bullets[e].angle),bullets[e].y+=10*Math.sin(bullets[e].angle);let n=!1;if([player,...aiPlayers].forEach(t=>{t!==bullets[e].shooter&&!t.inBuilding&&checkCollision(bullets[e],t)&&(t.health-=bullets[e].damage,t.health<=0&&(t===player?console.log("Game Over"):aiPlayers.splice(aiPlayers.indexOf(t),1)),n=!0)}),vehicles.forEach(t=>{checkCollision(bullets[e],t)&&(n=!0)}),map.buildings.forEach(t=>{checkCollision(bullets[e],t)&&(n=!0)}),n||bullets[e].x<0||bullets[e].x>map.width||bullets[e].y<0||bullets[e].y>map.height)bullets.splice(e,1)}}function shoot(e){if(e.gun&&e.magazineAmmo>0){const n=e.gun.bulletCount,t=.2;for(let a=0;a<n;a++){const i=e.angle+(n>1?t*(a-(n-1)/2):0);bullets.push({x:e.x+30*Math.cos(i),y:e.y+30*Math.sin(i),angle:i,damage:e.gun.damage,shooter:e})}e.magazineAmmo--}}function reload(e){if(e.gun&&e.ammo>0){const n=e.magazineSize-e.magazineAmmo,t=Math.min(n,e.ammo);e.magazineAmmo+=t,e.ammo-=t}}function checkCollision(e,n){return e.x<n.x+n.width&&e.x+e.width>n.x&&e.y<n.y+n.height&&e.y+e.height>n.y}function updateAI(e){switch(e.state){case"wandering":if(e.x+=Math.cos(e.angle)*e.speed,e.y+=Math.sin(e.angle)*e.speed,Math.random()<.02&&(e.angle=2*Math.random()*Math.PI),!e.inVehicle&&!e.inBuilding){let n=null,t=1/0;vehicles.forEach(a=>{if(a.driver&&!a.passenger||!a.driver){const i=Math.hypot(a.x-e.x,a.y-e.y);i<t&&(n=a,t=i)}}),n&&t<100&&(e.state="seeking_vehicle",e.target=n)}break;case"seeking_vehicle":const n=e.target.x-e.x,t=e.target.y-e.y;if(e.angle=Math.atan2(t,n),e.x+=Math.cos(e.angle)*e.speed,e.y+=Math.sin(e.angle)*e.speed,Math.hypot(n,t)<10){const a=e.target;a.driver?a.passenger||(a.passenger=e):a.driver=e,e.inVehicle=a,e.state="wandering",e.target=null}if(e.targetTimer++,e.targetTimer>300)e.state="wandering",e.target=null,e.targetTimer=0}e.inBuilding?(e.x=Math.max(e.inBuilding.x,Math.min(e.inBuilding.x+e.inBuilding.width-e.width,e.x)),e.y=Math.max(e.inBuilding.y,Math.min(e.inBuilding.y+e.inBuilding.height-e.height,e.y))):e.inVehicle?(e.x=e.inVehicle.x,e.y=e.inVehicle.y,e.angle=e.inVehicle.angle):(map.buildings.forEach(n=>{if(checkCollision(e,n)){const t=Math.min(e.x+e.width-n.x,n.x+n.width-e.x),a=Math.min(e.y+e.height-n.y,n.y+n.height-e.y);t<a?e.x+=e.x<n.x?-t:t:e.y+=e.y<n.y?-a:a}}),e.x=Math.max(0,Math.min(map.width,e.x)),e.y=Math.max(0,Math.min(map.height,e.y))),Math.random()<.01&&shoot(e),0===e.magazineAmmo&&Math.random()<.1&&reload(e),Math.random()<.005&&(e.inVehicle?(e.inVehicle.driver===e?e.inVehicle.driver=null:e.inVehicle.passenger=null,e.inVehicle=null,e.x+=40*Math.cos(e.angle),e.y+=40*Math.sin(e.angle)):e.inBuilding?e.inBuilding=null:map.buildings.forEach(n=>{Math.hypot(e.x-(n.x+n.width/2),e.y-(n.y+n.height))<50&&(e.inBuilding=n,e.y-=70)}))}function updateVehicle(e){if(e.driver){const n=e.driver===player?window.keys:{};n.w?e.speed=Math.min(e.speed+.1,e.maxSpeed):n.s?e.speed=Math.max(e.speed-.1,-e.maxSpeed/2):e.speed*=.98,n.a?e.steeringAngle=Math.max(-e.maxSteeringAngle,e.steeringAngle-.02):n.d?e.steeringAngle=Math.min(e.maxSteeringAngle,e.steeringAngle+.02):e.steeringAngle*=.9,e.angle+=e.steeringAngle*e.speed/30,e.x+=Math.cos(e.angle)*e.speed,e.y+=Math.sin(e.angle)*e.speed;let t=!1;vehicles.forEach(a=>{a!==e&&checkCollision(e,a)&&(t=!0)}),map.buildings.forEach(a=>{checkCollision(e,a)&&(t=!0)}),t&&(e.x-=Math.cos(e.angle)*e.speed,e.y-=Math.sin(e.angle)*e.speed,e.speed=0),e.x=Math.max(0,Math.min(map.width,e.x)),e.y=Math.max(0,Math.min(map.height,e.y)),e.driver.x=e.x,e.driver.y=e.y,e.passenger&&(e.passenger.x=e.x,e.passenger.y=e.y)}}function update(){player.inVehicle?updateVehicle(player.inVehicle):player.inBuilding?(keys.w&&(player.y-=player.speed),keys.s&&(player.y+=player.speed),keys.a&&(player.x-=player.speed),keys.d&&(player.x+=player.speed),player.x=Math.max(player.inBuilding.x,Math.min(player.inBuilding.x+player.inBuilding.width-player.width,player.x)),player.y=Math.max(player.inBuilding.y,Math.min(player.inBuilding.y+player.inBuilding.height-player.height,player.y))):(keys.w&&(player.y-=player.speed),keys.s&&(player.y+=player.speed),keys.a&&(player.x-=player.speed),keys.d&&(player.x+=player.speed)),aiPlayers.forEach(updateAI),vehicles.forEach(updateVehicle),player.inBuilding||(map.buildings.forEach(e=>{if(checkCollision(player,e)){const n=Math.min(player.x+player.width-e.x,e.x+e.width-player.x),t=Math.min(player.y+player.height-e.y,e.y+e.height-player.y);n<t?player.x+=player.x<e.x?-n:n:player.y+=player.y<e.y?-t:t}}),player.x=Math.max(0,Math.min(map.width,player.x)),player.y=Math.max(0,Math.min(map.height,player.y))),map.doors.forEach(e=>{const n=Math.hypot(player.x-e.x,player.y-e.y);n<50?(e.isOpen=!0,e.openAngle=Math.min(e.openAngle+.1,Math.PI/2)):n>=50&&(e.isOpen=!1,e.openAngle=Math.max(e.openAngle-.1,0))}),keys.e&&(player.inVehicle?(player.inVehicle.driver===player?player.inVehicle.driver=null:player.inVehicle.passenger=null,player.inVehicle=null,player.x+=40*Math.cos(player.angle),player.y+=40*Math.sin(player.angle)):player.inBuilding?(player.inBuilding=null,player.y+=70):vehicles.forEach(e=>{Math.hypot(player.x-e.x,player.y-e.y)<50&&(e.driver?e.passenger||(e.passenger=player):e.driver=player,player.inVehicle=e)}),keys.e=!1),keys.f&&(player.inBuilding||(map.buildings.forEach(e=>{Math.hypot(player.x-(e.x+e.width/2),player.y-(e.y+e.height))<50&&(player.inBuilding=e,player.y-=70)}),keys.f=!1)),keys.r&&(reload(player),keys.r=!1),camera.x=player.x-canvas.width/2,camera.y=player.y-canvas.height/2,camera.x=Math.max(0,Math.min(map.width-canvas.width,camera.x)),camera.y=Math.max(0,Math.min(map.height-canvas.height,camera.y)),updateBullets()}function render(){ctx.clearRect(0,0,canvas.width,canvas.height),drawMap(),vehicles.forEach(drawVehicle),aiPlayers.forEach(e=>e.inVehicle||e.inBuilding||drawPlayer(e)),player.inVehicle||player.inBuilding||drawPlayer(player),drawBullets(),drawHUD()}function gameLoop(){update(),render(),requestAnimationFrame(gameLoop)}const keys={};window.addEventListener("keydown",e=>keys[e.key]=!0),window.addEventListener("keyup",e=>keys[e.key]=!1),canvas.addEventListener("mousemove",e=>{const n=canvas.getBoundingClientRect(),t=e.clientX-n.left+camera.x,a=e.clientY-n.top+camera.y;player.angle=Math.atan2(a-player.y,t-player.x)}),canvas.addEventListener("click",()=>shoot(player)),window.addEventListener("resize",()=>{canvas.width=window.innerWidth,canvas.height=window.innerHeight});const weaponSlots=document.getElementById("weaponSlots");["H","P","S","R"].forEach(e=>{const n=document.createElement("div");n.className="weapon-slot",n.id=`slot${e}`,weaponSlots.appendChild(n)}),guns.forEach(e=>{const n=document.getElementById(`slot${e.slot}`),t=document.createElement("img");t.src=e.displayImage,t.style.width="100%",t.style.height="100%",t.addEventListener("click",()=>{player.gun=e,updateWeaponDisplay()}),n.appendChild(t)});function updateWeaponDisplay(){guns.forEach(e=>{const n=document.getElementById(`slot${e.slot}`);n.style.border=player.gun===e?"2px solid yellow":"none"})}const skinSelect=document.getElementById("skinSelect"),gloveSelect=document.getElementById("gloveSelect");skins.forEach(e=>{const n=document.createElement("option");n.value=e,n.textContent=e,skinSelect.appendChild(n)}),gloves.forEach(e=>{const n=document.createElement("option");n.value=e.name,n.textContent=e.name,gloveSelect.appendChild(n)}),skinSelect.addEventListener("change",e=>{player.skin=e.target.value}),gloveSelect.addEventListener("change",e=>{player.gloves=e.target.value}),document.getElementById("startGame").addEventListener("click",()=>{player.gun=player.gun||guns,player.username=document.getElementById("username").value||"Player",document.getElementById("menu").style.display="none",gameLoop()});</script></body></html>
