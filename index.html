<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Battle Royale Game</title><style>body,html{margin:0;padding:0;overflow:hidden}canvas{display:block}</style></head><body><canvas id="gameCanvas"></canvas><script>const canvas=document.getElementById("gameCanvas"),ctx=canvas.getContext("2d");canvas.width=window.innerWidth,canvas.height=window.innerHeight;const map={width:4e3,height:3e3,roadWidth:200,buildings:[],presents:[]},player={x:400,y:300,width:40,height:40,speed:3,angle:0,inVehicle:null,keys:[],gun:null,ammo:0,magazineSize:10,magazineAmmo:0},vehicles=[],bullets=[],camera={x:0,y:0},vehicleTypes=[{type:"car",width:50,height:30,speed:4,color:"#4286f4"},{type:"truck",width:70,height:40,speed:3,color:"#41f468"}],guns=[{name:"pistol",image:"pistol.png"},{name:"shotgun",image:"shotgun.png"},{name:"rifle",image:"rifle.png"}],playerImage=new Image;playerImage.src="player.png";const gunImages={};function drawMap(){ctx.fillStyle="#7CFC00",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle="#8B4513",ctx.fillRect(map.width/2-map.roadWidth/2-camera.x,0,map.roadWidth,canvas.height),ctx.fillRect(0,map.height/2-map.roadWidth/2-camera.y,canvas.width,map.roadWidth),ctx.fillStyle="#808080",map.buildings.forEach(e=>{ctx.fillRect(e.x-camera.x,e.y-camera.y,e.width,e.height),ctx.fillStyle="#A9A9A9",ctx.fillRect(e.x+e.width/2-10-camera.x,e.y-10-camera.y,20,10),ctx.fillStyle="#000000",ctx.font="20px Arial",ctx.fillText(e.number,e.x+10-camera.x,e.y+30-camera.y),ctx.fillStyle="#808080"}),ctx.fillStyle="#FF0000",map.presents.forEach(e=>{ctx.fillRect(e.x-camera.x,e.y-camera.y,e.width,e.height)})}function drawVehicle(e){ctx.save(),ctx.translate(e.x-camera.x,e.y-camera.y),ctx.rotate(e.angle),ctx.fillStyle=e.color,ctx.fillRect(-e.width/2,-e.height/2,e.width,e.height),ctx.fillStyle="#000000",ctx.save(),ctx.translate(e.width/2-10,-e.height/2),ctx.rotate(e.steeringAngle),ctx.fillRect(-5,-5,10,10),ctx.restore(),ctx.save(),ctx.translate(e.width/2-10,e.height/2),ctx.rotate(e.steeringAngle),ctx.fillRect(-5,-5,10,10),ctx.restore(),ctx.fillRect(-e.width/2+5,-e.height/2-5,10,10),ctx.fillRect(-e.width/2+5,e.height/2-5,10,10),ctx.restore()}function drawPlayer(){ctx.save(),ctx.translate(player.x-camera.x,player.y-camera.y),ctx.rotate(player.angle+Math.PI/2),ctx.drawImage(playerImage,-player.width/2,-player.height/2,player.width,player.height),player.gun&&ctx.drawImage(gunImages[player.gun.name],player.width/2,-player.height/4,player.width,player.height/2),ctx.restore()}function drawBullets(){ctx.fillStyle="#FF0000",bullets.forEach(e=>{ctx.beginPath(),ctx.arc(e.x-camera.x,e.y-camera.y,3,0,2*Math.PI),ctx.fill()})}function drawHUD(){ctx.fillStyle="#000000",ctx.font="20px Arial",ctx.fillText(`Keys: ${player.keys.join(", ")}`,10,30),ctx.fillText(`Gun: ${player.gun?player.gun.name:"None"}`,10,60),ctx.fillText(`Ammo: ${player.magazineAmmo}/${player.ammo}`,10,90)}function updateBullets(){for(let e=bullets.length-1;e>=0;e--)bullets[e].x+=10*Math.cos(bullets[e].angle),bullets[e].y+=10*Math.sin(bullets[e].angle),(bullets[e].x<0||bullets[e].x>map.width||bullets[e].y<0||bullets[e].y>map.height)&&bullets.splice(e,1)}function shoot(){player.gun&&player.magazineAmmo>0&&(bullets.push({x:player.x+30*Math.cos(player.angle),y:player.y+30*Math.sin(player.angle),angle:player.angle}),player.magazineAmmo--)}function reload(){if(player.gun&&player.ammo>0){const e=player.magazineSize-player.magazineAmmo,a=Math.min(e,player.ammo);player.magazineAmmo+=a,player.ammo-=a}}function checkCollision(e,a){return e.x<a.x+a.width&&e.x+e.width>a.x&&e.y<a.y+a.height&&e.y+e.height>a.y}function update(){if(player.inVehicle){const e=player.inVehicle;keys.w&&(e.x+=Math.cos(e.angle)*e.speed,e.y+=Math.sin(e.angle)*e.speed),keys.s&&(e.x-=Math.cos(e.angle)*e.speed/2,e.y-=Math.sin(e.angle)*e.speed/2),keys.a&&(e.steeringAngle=Math.max(-e.maxSteeringAngle,e.steeringAngle-.05)),keys.d&&(e.steeringAngle=Math.min(e.maxSteeringAngle,e.steeringAngle+.05)),e.angle+=e.steeringAngle*e.speed/30,e.steeringAngle*=.9,player.x=e.x,player.y=e.y,player.angle=e.angle}else keys.w&&(player.y-=player.speed),keys.s&&(player.y+=player.speed),keys.a&&(player.x-=player.speed),keys.d&&(player.x+=player.speed);if(map.buildings.forEach(e=>{if(checkCollision(player,e))if(player.keys.includes(e.number))player.gun=e.gun,player.ammo=400,player.magazineAmmo=player.magazineSize,player.keys=player.keys.filter(a=>a!==e.number);else{const a=Math.min(player.x+player.width-e.x,e.x+e.width-player.x),l=Math.min(player.y+player.height-e.y,e.y+e.height-player.y);a<l?player.x+=player.x<e.x?-a:a:player.y+=player.y<e.y?-l:l}}),map.presents.forEach((e,a)=>{checkCollision(player,e)&&(player.keys.push(e.key),map.presents.splice(a,1))}),keys.e&&(player.inVehicle?(player.inVehicle=null,player.x+=40*Math.cos(player.angle),player.y+=40*Math.sin(player.angle)):vehicles.forEach(e=>{Math.hypot(player.x-e.x,player.y-e.y)<50&&(player.inVehicle=e)}),keys.e=!1),keys.r&&(reload(),keys.r=!1),player.x=Math.max(0,Math.min(map.width,player.x)),player.y=Math.max(0,Math.min(map.height,player.y)),camera.x=player.x-canvas.width/2,camera.y=player.y-canvas.height/2,camera.x=Math.max(0,Math.min(map.width-canvas.width,camera.x)),camera.y=Math.max(0,Math.min(map.height-canvas.height,camera.y)),updateBullets()}function render(){ctx.clearRect(0,0,canvas.width,canvas.height),drawMap(),vehicles.forEach(drawVehicle),drawPlayer(),drawBullets(),drawHUD()}function gameLoop(){update(),render(),requestAnimationFrame(gameLoop)}guns.forEach(e=>{gunImages[e.name]=new Image,gunImages[e.name].src=e.image});for(let e=0;e<40;e++)map.buildings.push({x:Math.random()*map.width,y:Math.random()*map.height,width:100+200*Math.random(),height:100+200*Math.random(),number:e+1,gun:guns[Math.floor(Math.random()*guns.length)]});for(let e=0;e<100;e++)map.presents.push({x:Math.random()*map.width,y:Math.random()*map.height,width:20,height:20,key:Math.floor(40*Math.random())+1});for(let e=0;e<4;e++){const a=vehicleTypes[Math.floor(Math.random()*vehicleTypes.length)];vehicles.push({...a,x:Math.random()*map.width,y:Math.random()*map.height,angle:2*Math.random()*Math.PI,steeringAngle:0,maxSteeringAngle:Math.PI/4})}const keys={};window.addEventListener("keydown",e=>keys[e.key]=!0),window.addEventListener("keyup",e=>keys[e.key]=!1),canvas.addEventListener("mousemove",e=>{const a=canvas.getBoundingClientRect(),l=e.clientX-a.left+camera.x,t=e.clientY-a.top+camera.y;player.angle=Math.atan2(t-player.y,l-player.x)-Math.PI/2}),canvas.addEventListener("click",shoot),window.addEventListener("resize",()=>{canvas.width=window.innerWidth,canvas.height=window.innerHeight}),gameLoop();</script></body></html>
